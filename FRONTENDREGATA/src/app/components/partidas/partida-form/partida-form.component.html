<div class="partida-form">
  <div class="header">
    <h2>{{ isEditMode() ? 'Editar Partida' : 'Crear Nueva Partida' }}</h2>
  </div>

  @if (loading()) {
    <div class="loading">Cargando datos...</div>
  }

  @if (error()) {
    <div class="error">{{ error() }}</div>
  }

  <form (ngSubmit)="savePartida()" #partidaForm="ngForm">
    <div class="form-group">
      <label for="estado">Estado *</label>
      <select 
        id="estado"
        name="estado"
        #estado="ngModel"
        [(ngModel)]="partida().estado"
        required
        class="form-control">
        <option value="">Selecciona un estado</option>
        <option value="ESPERANDO">Esperando</option>
        <option value="EN_JUEGO">En Juego</option>
        <option value="TERMINADA">Terminada</option>
      </select>
      @if (estado.invalid && estado.touched) {
        <div class="field-error">Debe seleccionar un estado</div>
      }
    </div>

    <div class="form-group">
      <label for="mapaId">ID del Mapa *</label>
      <input 
        type="number" 
        id="mapaId"
        name="mapaId"
        #mapaId="ngModel"
        [(ngModel)]="partida().mapaId"
        required
        min="1"
        class="form-control"
        placeholder="Ingresa el ID del mapa">
      @if (mapaId.invalid && mapaId.touched) {
        <div class="field-error">
          @if (mapaId.errors?.['required']) {
            El ID del mapa es obligatorio
          } @else if (mapaId.errors?.['min']) {
            El ID del mapa debe ser mayor a 0
          }
        </div>
      }
    </div>

    <div class="form-actions">
      <button 
        type="button" 
        class="btn btn-secondary"
        (click)="partidaForm.resetForm()">
        Limpiar
      </button>
      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="saving() || partidaForm.invalid">
        @if (saving()) {
          Guardando...
        } @else {
          {{ isEditMode() ? 'Actualizar' : 'Crear' }} Partida
        }
      </button>
    </div>
  </form>
</div>